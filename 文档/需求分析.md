# 需求分析
## 功能要求
### 概述
在内存中模拟一个虚拟磁盘，并可以接受命令行参数，并根据所接收到的命令行参数，正确的完成相应的对文件的操作以及显示功能，同时可以对虚拟磁盘进行到硬盘上的序列化及反序列化功能。
### 注意事项
* 在处理命令行参数时，对于路径中的‘\’及‘/’， 应该均可以正确处理。
* 能够处理绝对路径以及相对路径，其主要区别为是否以盘符作为起始，能够处理'.'和'..'文件夹
* 能够实现链接文件（快捷方式），并且在其所指向的文件被删除时，应该无法通过链接文件找到源文件，请求其所指向的文件时，应返回空
* 应该事先包括'*'和'?'在内的通配符功能
* 相当一部分命令行参数出现位置不固定
* 可以直接通过文件链接对相应的文件夹或文件进行操作及访问
* 当链接文件在访问时存在死递归时，windows无法识别对应的符号链接，例如aa为目录b的符号链接，aa内存在到aa文件夹的链接b，则b无法正确访问。
* 为符号链接（a）创建符号链接（b）时，符号链接b时指向a，而非a所指向的文件或文件夹
* 其中命令行参数中带通配符的包括如下几个（暂时都只在路径中的最后一部分中出现，还问题不大）：*dir* *cd*，*copy*，*del*，*move*，*ren*，其中的作用分别是
>* dir 当附带通配符时，只显示与通配符内容相匹配的文件
>* cd 打开第一个匹配通配符的文件夹
>* copy 复制所有匹配通配符的文件到相应的文件夹中，存在通配符时暂时不需要进行相应的重命名工作，其中当存在通配符时，只会匹配与通配符相匹配的文件，不包括文件夹，当路径为绝对路径时，暂时路径中不包括通配符
>* del 删除所有匹配的文件
>* move 仅能在source中存在通配符，仅移动第一个匹配的文件到相应的路径或文件内
>* ren 样例中仅在source部分中出现通配符，未在dest中出现通配符，仅对第一个匹配的文件进行重命名，其他文件报已存在相应文件的错误
>* 

## 需要实现的命令行操作
### dir
#### **功能** 列出当前目录下的目录和文件
#### **格式** dir [/s] [/ad] [path1] [path2] [path..]
#### **额外的命令行参数**
* /s 递归输出所有目录及子目录下的文件及文件夹
* /ad 仅输出文件夹，与/s合用时，递归输出所有文件夹
#### **细节**
* 当不存在通配符时，path所制定的应该是某个文件夹，输出相应文件夹下的数据
* 当存在通配符时，通配符一定是路径的最后一部分，只用于判断文件名是否与之匹配
* 通配符不会用于路径的匹配
### md
#### **功能** 创建目录
#### **格式** md path
#### **额外的命令行参数** 无
#### **细节**
* 当路径中存在链接文件时，应该能通过链接文件找到相应的路径，进行相应的跳转
### cd
#### **功能** 当仅输入cd时，显示当前文件夹的路径，当后面跟随绝对或相对路径时，将当前所在文件夹跳转至相应的文件夹
#### **格式** cd [path]
#### **额外的命令行参数** 无
#### **细节**
同上
### copy
#### **功能** 将任意目录下的文件内容拷贝到虚拟磁盘中的任意路径内，并且能够支持'?'及'*'通配符，支持真实磁盘路径（以@开头）
#### **格式** copy sourcepath destpath [\y]
#### **额外的命令行参数**
* /y 当目标路径上存在相应文件时，可无需确认，直接进行覆盖
#### **细节**
* 暂时，仅在source path中存在通配符，且存在通配符时不需要考虑重命名
* 当sourcepath为目录时，会将sourcepath中的所有文件（不包括子目录下的文件）拷贝至destpath指定的位置
* 当sourcepath为包含通配符的路径时，将所有匹配通配符的文件拷贝至sourcepath指定的位置
* 当destpath为目录时，会将文件拷贝至destpath指定的目录下
* 当destpath包含通配符时，会将文件按照通配符之间的匹配规则重命名为相应文件名(这里不存在当包含通配符时的重命名，包含通配符的时候直接使用原文件名即可)
* 当destpath只对应单个文件，但是sourcepath对应了多个文件(包含通配符或者是目录)时，会将所有文件拷贝至相应的文件中，生成一个大文件
* 当sourcepath指定的文件中包括符号链接时，将符号链接视为其所指向的文件并进行操作。
* 当destpath指定的文件为符号连接时，对符号链接所指向的文件进行操作，而非将符号链接替换为新文件
* 当destpath指定的文件为真实磁盘上的文件时，不会存在需要应用通配符等情况
* 当destpath指定为文件夹时，如果文件夹不存在，copy失败
* 当destpath指定为指向文件的符号链接时，如果符号链接所指向的文件已经被删除，那么会重新创建相应的文件
* 只存在多对一和一对一的情况，不存在数量不匹配的多对多的情况
### del
#### **功能** 删除一个或多个文件，当path中只指定文件夹，没有指定相应文件时，可视为path/*
#### **格式** del [/s] path1 [path2] [path...]
#### **额外的命令行参数**
* /s 递归删除目录及子目录下的相应文件（保留文件夹）
#### **细节**
* 当删除一个符号链接时，如果这个链接指向一个文件，那么删除这个链接本身，如果这个链接指向一个目录，那么不删除这个链接，而是对链接所指向的目录进行操作。
### rd
#### **功能** 删除一个空的目录（其参数只能是目录路径）
#### **格式** rd[/s] path1 [path2] [path...]
#### **额外的命令行参数**
* /s 删除相应文件夹，以及其中的全部文件，不验证是否为空目录
#### **细节**
* 当删除一个符号链接时，如果这个符号链接指向一个文件夹，那么不论是否有/s参数，以及所指向的文件夹是否为空，都只删除这个符号链接本身，不对其所指向的文件夹进行修改。
* 删除盘符时删除失败
### ren
#### **功能** 重命名文件或文件夹或链接文件
#### **格式** ren source dest
#### **额外的命令行参数** 无
#### **细节**
* 当dest指定的文件名（包括文件夹名）已经存在时，会失败
* 当source指定的文件名不存在时，会报错
* 当source中包含通配符时，第一个文件会正确重命名，其后的文件会重命名失败，错误为存在重名文件
* 暂时不需要考虑dest中包含通配符的情况
* 在存在符号链接指向source所指定的文件或文件夹时，在source被重命名后，原来相应的文件链接会失效
* 当source中包含通配符时，其只对文件生效，不对目录进行重命名等操作。
* 当对符号链接重命名时，仅操作符号链接文件本身，不修改其所指向的文件。
* 当dest所指定的文件在暂时不存在的目录中时，会失败
* ren只完成重命名工作，dest部分只指定文件名，不包括路径
### move
#### **功能** 移动一个文件或文件夹、
* 当dest指向一个已经存在的文件夹时，则将source指定的文件或文件夹移动至dest内，文件名称不变
* 其他情况下，将source所指定的文件或文件夹移动至dest所指定的目录，并根据dest中最后一部分为文件或文件夹重命名
#### **格式** move /y source dest
#### **额外的命令行参数**
* /y 遇到重名的文件或文件夹时直接覆盖
#### **细节**
* 暂时只在source中存在通配符，当存在通配符时，只会匹配文件，不会匹配目录
* 当dest指定的文件在不存在的目录中的时候，移动失败
* 当source为一个符号链接时，只将这个符号链接移动至相应的位置，不修改原本符号链接所指向的文件夹或是文件以及其中的内容
* 当source为一个文件夹时，会将整个文件夹移动至dest指定的位置。
* 当dest是一个指向文件夹的符号链接时，会将source中指定的文件或文件夹移动至dest所指定的文件夹中
* 当dest是一个指向文件的符号连接时，会将dest变成文件，而非将文件移动至符号链接所指定的文件上。
* 当source中包括一个文件file1，且目标路径内存在与之同名的文件夹dir2，则file1的移动会失败，其余文件正常移动
* 暂时仅当dest为直接指定的文件名时需要对文件进行重命名，其他情况下不需要
* source可能指定的情况：通配符（指定文件夹中匹配通配符的多个文件），单个文件夹
* dest可能指定的情况：包含通配符的文件名（暂时不涉及到根据通配符进行重命名，可简单视为父目录路径），单个文件，单个目录
### mklink
#### **功能** 根据指定的虚拟磁盘中的一个路径建立符号链接，创建时应验证路径是否存在，并根据是否存在/d参数，验证是否为文件夹类型
* windows7下的mklink在如下命令行参数时似乎工作异常，所创建的符号链接无法正常工作
* `mklink gtest/a a.txt`
#### **格式** mklink [/d] srcPath symbolLinkPath
#### **额外的命令行参数**
* /d 为目录创建符号链接
#### **细节**
* 当为符号链接所指定的路径上已经存在相应的文件时，符号链接会创建失败
* 符号链接创建时应该验证是否存在目标文件，以及目标文件类型
* 当src所指定的文件也为一个符号链接时，新创建的符号链接指向原来的符号链接，而非符号链接所指向的文件
### save
#### **功能** 将虚拟磁盘序列化至硬盘上的一个文件中
#### **格式** save destPath
#### **额外的命令行参数** 无
### load
#### **功能** 将存储到硬盘中的虚拟磁盘反序列化至内存
#### **格式** load sourcePath
#### **额外的命令行参数** 无
### cls
#### **功能** 清空屏幕
#### **格式** cls
#### **额外的命令行参数** 无
